<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Weekly POC</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <base href="./"> <!-- keeps fetch() paths relative to this folder -->
  <style>
    body{margin:0;font-family:Georgia,serif;background:#d9d9d9;display:flex;justify-content:center}
    .app{width:1100px;background:#fff;min-height:100vh;box-shadow:0 0 10px rgba(0,0,0,.2);display:flex;flex-direction:column}
    header.app-header{background:#444;color:#fff;padding:12px 20px;display:flex;justify-content:center}
    .header-nav{display:inline-flex;gap:20px}
    .header-nav a{color:#fff;text-decoration:none;font-weight:700}
    .header-nav a.active{text-decoration:underline}
    main{flex:1;padding:20px}
    .card{background:#fafafa;border:1px solid #ddd;border-radius:8px;padding:16px}
    footer{text-align:center;font-size:12px;padding:12px;color:#666;border-top:1px solid #ddd}
  </style>
</head>
<body>
  <div class="app">
    <header class="app-header">
      <nav class="header-nav">
        <a href="#/home">Home</a>
        <a href="#/screen1">Screen 1</a>
        <a href="#/screen2">Screen 2</a>
        <a href="#/screen3">Screen 3</a>
      </nav>
    </header>
    <!-- put this somewhere inside <body> of app.html -->
<template id="home-fragment">
  <div class="card">
    <h2>Welcome</h2>
    <p>This is the home screen. Use the nav above to open Screen 1–3.</p>
  </div>
</template>

<main id="main"><div class="card">Loading…</div></main>

    <main id="main"><div class="card">Loading…</div></main>
    <footer>POC Footer</footer>
  </div>

  <!-- OPTIONAL: mock data; keep if you used it -->
  <script src="mock.js"></script>

  <script>
    // All lowercase to match your renamed files at the repo root
    const ROUTES = {
screen1: { html: "screen1.html", js: "screen1.js" },
      screen2: { html: "screen2.html", js: "screen2.js" },
      screen3: { html: "screen3.html", js: "screen3.js" }
    };

    function loadScript(src) {
      return new Promise((resolve, reject) => {
        const s = document.createElement("script");
        s.src = src + `?v=${Date.now()}`;     // cache-buster
        s.onload = resolve;
        s.onerror = () => reject(new Error("Failed to load " + src));
        document.body.appendChild(s);
      });
    }

    async function navigate() {
      const hash = location.hash || "#/home";
      const key  = hash.slice(2);
      const route = ROUTES[key];

      // highlight active tab
      document.querySelectorAll(".header-nav a").forEach(a =>
        a.classList.toggle("active", a.getAttribute("href") === hash)
      );

      const main = document.getElementById("main");
      if (!route) {
        main.innerHTML = `<div class="card"><h2>Not found</h2><p>No route: ${key}</p></div>`;
        return;
      }

      // For debug: see exactly what URL we try to fetch
      const expectedUrl = new URL(route.html, location.href).href;
      console.log("Loading fragment:", expectedUrl);

      // load the HTML fragment
      try {
        const resp = await fetch(route.html, { cache: "no-cache" });
        if (!resp.ok) throw new Error(`Failed to fetch ${route.html} (${resp.status})`);
        main.innerHTML = await resp.text();
      } catch (e) {
        console.error(e);
        main.innerHTML = `<div class="card">
          <h2>Load error</h2>
          <p>${e.message}</p>
          <p>Expected at: <code>${expectedUrl}</code></p>
          <p>Make sure the file exists at the repo root with EXACT lowercase name.</p>
        </div>`;
        return;
      }

      // load & run the screen script if specified
      if (route.js) {
        try { await loadScript(route.js); }
        catch (e) {
          console.error(e);
          const warn = document.createElement("div");
          warn.className = "card";
          warn.innerHTML = `<h3>Script load error</h3><p>${e.message}</p>`;
          main.appendChild(warn);
        }
      }
    }

    window.addEventListener("hashchange", navigate);
    window.addEventListener("DOMContentLoaded", navigate);
  </script>
</body>
</html>


